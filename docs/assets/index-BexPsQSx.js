var C=Object.defineProperty;var b=(n,t,i)=>t in n?C(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var a=(n,t,i)=>b(n,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))e(h);new MutationObserver(h=>{for(const s of h)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function i(h){const s={};return h.integrity&&(s.integrity=h.integrity),h.referrerPolicy&&(s.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?s.credentials="include":h.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(h){if(h.ep)return;h.ep=!0;const s=i(h);fetch(h.href,s)}})();class M{constructor(){a(this,"audioContext");a(this,"enabled");a(this,"gameOver");this.enabled=!0,this.gameOver=!1,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}setGameOver(t){this.gameOver=t}playShoot(){if(!this.enabled||this.gameOver)return;const t=this.audioContext.createOscillator(),i=this.audioContext.createGain();t.type="square",t.frequency.setValueAtTime(880,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(110,this.audioContext.currentTime+.1),i.gain.setValueAtTime(.08,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.1),t.connect(i),i.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.1)}playBombDrop(){if(!this.enabled||this.gameOver)return;const t=this.audioContext.createOscillator(),i=this.audioContext.createGain();t.type="sine",t.frequency.setValueAtTime(440,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(220,this.audioContext.currentTime+.3),i.gain.setValueAtTime(.02,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.3),t.connect(i),i.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.3)}playExplosion(){if(!this.enabled||this.gameOver)return;const t=this.audioContext.createBufferSource(),i=this.audioContext.createBuffer(1,this.audioContext.sampleRate*.3,this.audioContext.sampleRate),e=i.getChannelData(0);for(let o=0;o<i.length;o++)e[o]=Math.random()*2-1;t.buffer=i;const h=this.audioContext.createBiquadFilter();h.type="lowpass",h.frequency.setValueAtTime(1e3,this.audioContext.currentTime),h.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+.3);const s=this.audioContext.createGain();s.gain.setValueAtTime(.1,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.3),t.connect(h),h.connect(s),s.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.3)}playGameOver(){if(!this.enabled||this.gameOver)return;const t=this.audioContext.createBufferSource(),i=this.audioContext.createBuffer(1,this.audioContext.sampleRate*2,this.audioContext.sampleRate),e=i.getChannelData(0);for(let x=0;x<i.length;x++){const r=1-x/i.length;e[x]=(Math.random()*2-1)*r}t.buffer=i;const h=this.audioContext.createBiquadFilter();h.type="lowpass",h.frequency.setValueAtTime(2e3,this.audioContext.currentTime),h.frequency.exponentialRampToValueAtTime(50,this.audioContext.currentTime+2);const s=this.audioContext.createGain();s.gain.setValueAtTime(.15,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+2);const o=this.audioContext.createOscillator();o.type="sine",o.frequency.setValueAtTime(220,this.audioContext.currentTime),o.frequency.exponentialRampToValueAtTime(110,this.audioContext.currentTime+2);const c=this.audioContext.createGain();c.gain.setValueAtTime(.05,this.audioContext.currentTime),c.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+2),t.connect(h),h.connect(s),s.connect(this.audioContext.destination),o.connect(c),c.connect(this.audioContext.destination),t.start(),o.start(),t.stop(this.audioContext.currentTime+2),o.stop(this.audioContext.currentTime+2)}playAlienTurn(){if(!this.enabled||this.gameOver)return;const t=this.audioContext.createOscillator(),i=this.audioContext.createGain();t.type="sine",t.frequency.setValueAtTime(330,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(440,this.audioContext.currentTime+.2),i.gain.setValueAtTime(.03,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.2),t.connect(i),i.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.2)}playAlienHover(t){if(!this.enabled||this.gameOver)return;const i=this.audioContext.createOscillator(),e=this.audioContext.createGain();switch(t){case 1:i.type="sawtooth",i.frequency.setValueAtTime(880,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(1760,this.audioContext.currentTime+.05),e.gain.setValueAtTime(.015,this.audioContext.currentTime);break;case 2:i.type="square",i.frequency.setValueAtTime(660,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(880,this.audioContext.currentTime+.05),e.gain.setValueAtTime(.02,this.audioContext.currentTime);break;case 3:i.type="sawtooth",i.frequency.setValueAtTime(440,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(660,this.audioContext.currentTime+.05),e.gain.setValueAtTime(.018,this.audioContext.currentTime);break}e.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.05),i.connect(e),e.connect(this.audioContext.destination),i.start(),i.stop(this.audioContext.currentTime+.05)}toggle(){this.enabled=!this.enabled}}class A{constructor(){a(this,"canvas");a(this,"ctx");a(this,"player");a(this,"bullets");a(this,"aliens");a(this,"bombs");a(this,"explosions");a(this,"stars");a(this,"keys");a(this,"lastBulletTime");a(this,"BULLET_COOLDOWN",100);a(this,"MAX_PLAYER_BULLETS",5);a(this,"gameOver");a(this,"gameStartTime");a(this,"gameOverTime");a(this,"MIN_GAME_OVER_DURATION",3e3);a(this,"soundManager");a(this,"score");a(this,"highScore");a(this,"level");a(this,"levelStartTime");a(this,"LEVEL_START_DELAY",2e3);a(this,"gameStarted");a(this,"starPulseTime");this.canvas=document.getElementById("gameCanvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=800,this.canvas.height=600,this.player={x:this.canvas.width/2,y:this.canvas.height-50,width:40,height:40,speed:5},this.bullets=[],this.aliens=[],this.bombs=[],this.explosions=[],this.stars=[],this.keys={},this.lastBulletTime=0,this.gameOver=!1,this.gameStarted=!1,this.gameStartTime=Date.now(),this.gameOverTime=0,this.starPulseTime=0,this.soundManager=new M,this.score=0,this.highScore=parseInt(localStorage.getItem("galagaHighScore")||"0"),this.level=1,this.levelStartTime=Date.now(),this.initStars(),window.addEventListener("keydown",t=>this.keys[t.key]=!0),window.addEventListener("keyup",t=>this.keys[t.key]=!1),window.addEventListener("keydown",t=>{t.key.toLowerCase()==="m"&&this.soundManager.toggle()}),this.gameLoop()}createExplosion(t,i){this.explosions.push({x:t,y:i,radius:0,maxRadius:50,speed:2,active:!0}),this.soundManager.playExplosion()}initAliens(){const e=10+(this.level-1)*5,h=Math.ceil(Math.sqrt(e)),s=Math.ceil(e/h),o=60,c=(this.canvas.width-h*o)/2,x=50,r=500,f=2+(this.level-1)*.2;let u=0;for(let y=0;y<s&&u<e;y++)for(let m=0;m<h&&u<e;m++){const w=c+m*o,T=x+y*o,S=m%2===0?-100:this.canvas.width+100,P=-100-y*50,v=Math.random();let g;v<.1?g=3:v<.4?g=2:g=1;let p=f;g===2?p=f*1.5:g===3&&(p=f*.7),this.aliens.push({x:S,y:P,width:30,height:30,speed:p+Math.random(),direction:1,verticalSpeed:0,moveTimer:Date.now(),moveInterval:Math.max(500,1e3-(this.level-1)*50),lastBombTime:0,bombInterval:Math.max(500,1e3-(this.level-1)*50),nextBombDelay:1e3+Math.random()*1500,canDropBombs:!1,targetX:w,targetY:T,state:0,swoopPhase:Math.random()*Math.PI*2,swoopAmplitude:30+Math.random()*20,swoopSpeed:g===3?.04+Math.random()*.02:.02+Math.random()*.02,attackStartTime:0,originalX:w,originalY:T,entryDelay:u*r,type:g,bombSequence:0,lastBombSequence:0,isLeader:!1,followingLeader:null,attackPath:[],attackPathIndex:0}),u++}}initStars(){for(let t=0;t<100;t++)this.stars.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,size:Math.random()*2+1,speed:Math.random()*1.2+.5,color:this.getRandomDullColor()})}getRandomDullColor(){const t=["#8a8a8a","#8a4a4a","#4a8a4a","#4a4a8a","#8a8a4a","#8a4a8a","#4a8a8a","#6a6a8a","#8a6a4a"];return t[Math.floor(Math.random()*t.length)]}updateStars(){const t=Date.now();this.starPulseTime=(t-this.gameStartTime)/1e3,this.stars.forEach(i=>{if(this.gameStarted)i.y+=i.speed,i.y>this.canvas.height&&(i.y=0,i.x=Math.random()*this.canvas.width);else{const e=Math.sin(this.starPulseTime*2+i.x*.01)*.5+.5;i.size=(Math.random()*2+1)*(.5+e*.5)}})}drawStars(){this.stars.forEach(t=>{this.ctx.fillStyle=t.color,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill()})}handleInput(){if(!this.gameStarted){this.keys[" "]&&(this.gameStarted=!0,this.initAliens());return}if(this.gameOver){const t=Date.now()-this.gameOverTime;this.keys[" "]&&t>=this.MIN_GAME_OVER_DURATION&&this.reset();return}this.keys.ArrowLeft&&(this.player.x=Math.max(0,this.player.x-this.player.speed)),this.keys.ArrowRight&&(this.player.x=Math.min(this.canvas.width-this.player.width,this.player.x+this.player.speed)),this.keys[" "]&&Date.now()-this.lastBulletTime>this.BULLET_COOLDOWN&&this.bullets.filter(i=>i.isPlayerBullet).length<this.MAX_PLAYER_BULLETS&&(this.bullets.push({x:this.player.x+this.player.width/2-2,y:this.player.y,width:4,height:10,speed:7,isPlayerBullet:!0}),this.lastBulletTime=Date.now(),this.soundManager.playShoot())}reset(){this.player.x=this.canvas.width/2,this.player.y=this.canvas.height-50,this.bullets=[],this.bombs=[],this.explosions=[],this.aliens=[],this.stars=[],this.gameOver=!1,this.gameStarted=!1,this.gameOverTime=0,this.lastBulletTime=0,this.gameStartTime=Date.now(),this.score=0,this.level=1,this.levelStartTime=Date.now(),this.initStars(),this.soundManager.setGameOver(!1)}handlePlayerDeath(){this.createExplosion(this.player.x+this.player.width/2,this.player.y+this.player.height/2),this.gameOver=!0,this.gameOverTime=Date.now(),this.soundManager.setGameOver(!0),this.soundManager.playGameOver()}startNextLevel(){this.score+=1e3,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("galagaHighScore",this.highScore.toString())),this.level++,this.levelStartTime=Date.now(),this.initAliens()}update(){const t=Date.now(),i=t-this.gameStartTime;this.updateStars(),this.aliens.length===0&&t-this.levelStartTime>this.LEVEL_START_DELAY&&this.startNextLevel(),this.explosions=this.explosions.filter(e=>(e.radius+=e.speed,e.radius<e.maxRadius)),this.bullets=this.bullets.filter(e=>(e.isPlayerBullet?e.y-=e.speed:e.y+=e.speed,!this.gameOver&&!e.isPlayerBullet&&e.x<this.player.x+this.player.width&&e.x+e.width>this.player.x&&e.y<this.player.y+this.player.height&&e.y+e.height>this.player.y?(this.handlePlayerDeath(),!1):e.y>0&&e.y<this.canvas.height)),this.aliens.forEach(e=>{if(e.state===0&&i>=e.entryDelay&&(e.state=1),e.state!==0){if(!this.gameOver&&e.x<this.player.x+this.player.width&&e.x+e.width>this.player.x&&e.y<this.player.y+this.player.height&&e.y+e.height>this.player.y){this.handlePlayerDeath();return}switch(e.state){case 1:const h=e.targetX-e.x,s=e.targetY-e.y,o=Math.sqrt(h*h+s*s);o<5?(e.x=e.targetX,e.y=e.targetY,e.state=e.type===4?3:2,e.speed=2,e.originalX=e.x,e.originalY=e.y,e.moveTimer=t):(e.x+=h/o*e.speed,e.y+=s/o*e.speed);break;case 2:if(t-e.moveTimer>e.moveInterval&&this.aliens.forEach(c=>{c.state===2&&(c.direction*=-1,c.moveTimer=t,this.soundManager.playAlienHover(c.type))}),e.x+=e.speed*e.direction,e.x<0?(e.x=0,e.direction*=-1,this.soundManager.playAlienHover(e.type)):e.x+e.width>this.canvas.width&&(e.x=this.canvas.width-e.width,e.direction*=-1,this.soundManager.playAlienHover(e.type)),e.originalX=e.x,Math.random()<.001){e.state=3,e.attackStartTime=t,e.swoopPhase=0,e.isLeader=!0,e.attackPath=[],e.attackPathIndex=0;const c=this.aliens.filter(r=>r!==e&&r.state===2&&Math.abs(r.x-e.x)<100&&Math.abs(r.y-e.y)<100),x=Math.min(2,c.length);for(let r=0;r<x;r++){const d=c[r];d.state=3,d.attackStartTime=t+500,d.isLeader=!1,d.followingLeader=e,d.attackPath=[],d.attackPathIndex=0}}e.canDropBombs||t-e.entryDelay>e.nextBombDelay&&(e.canDropBombs=!0,e.lastBombTime=t);break;case 3:if(e.type===4){const c=t*.001,x=e.originalX+Math.sin(c*e.swoopSpeed)*e.swoopAmplitude,r=e.originalY+Math.sin(c*e.swoopSpeed*2)*(e.swoopAmplitude*.7),d=x-e.x,l=r-e.y;e.x+=d*.4,e.y+=l*.4,Math.random()<.04&&this.soundManager.playAlienHover(4),e.x<0&&(e.x=0),e.x+e.width>this.canvas.width&&(e.x=this.canvas.width-e.width),e.y<0&&(e.y=0),e.y+e.height>this.canvas.height&&(e.y=this.canvas.height-e.height)}else{const x=(t-e.attackStartTime)/3e3;if(x>=1)e.state=2,e.x=e.originalX,e.y=e.originalY,e.isLeader=!1,e.followingLeader=null,e.attackPath=[],e.attackPathIndex=0,this.soundManager.playAlienHover(e.type);else if(e.isLeader){const r=e.originalX+Math.sin(x*Math.PI*2)*100,d=e.originalY+Math.sin(x*Math.PI)*300;e.attackPath.push({x:r,y:d});const l=r-e.x,f=d-e.y;e.x+=l*.1,e.y+=f*.1}else if(e.followingLeader&&e.followingLeader.attackPath.length>0&&(e.attackPath.length===0&&(e.attackPath=[...e.followingLeader.attackPath]),e.attackPathIndex<e.attackPath.length)){const r=e.attackPath[e.attackPathIndex];if(r){const d=r.x-e.x,l=r.y-e.y;Math.sqrt(d*d+l*l)<5?e.attackPathIndex++:(e.x+=d*.1,e.y+=l*.1)}}}break}e.canDropBombs&&t-e.lastBombTime>(e.state===3?e.bombInterval*.3:e.bombInterval)&&e.y>0&&e.y<this.canvas.height&&(e.type===3?(e.bombSequence===0&&(e.bombSequence=1,e.lastBombSequence=t),e.bombSequence<=8&&t-e.lastBombSequence<2e3?(this.bombs.push({x:e.x+e.width/2-2,y:e.y+e.height,width:4,height:10,speed:3,horizontalSpeed:-1,active:!0,alienType:e.type}),this.bombs.push({x:e.x+e.width/2-2,y:e.y+e.height,width:4,height:10,speed:3,horizontalSpeed:1,active:!0,alienType:e.type}),e.bombSequence++,e.lastBombTime=t+50,this.soundManager.playBombDrop()):(e.bombSequence=0,e.lastBombTime=t+500+Math.random()*1e3)):(this.bombs.push({x:e.x+e.width/2-2,y:e.y+e.height,width:4,height:10,speed:3,horizontalSpeed:e.direction*.5,active:!0,alienType:e.type}),e.lastBombTime=t+200+Math.random()*800,this.soundManager.playBombDrop()))}}),this.bombs=this.bombs.filter(e=>(e.y+=e.speed,e.x+=e.horizontalSpeed,!this.gameOver&&e.active&&e.x<this.player.x+this.player.width&&e.x+e.width>this.player.x&&e.y<this.player.y+this.player.height&&e.y+e.height>this.player.y?(this.handlePlayerDeath(),!1):e.x<-e.width||e.x>this.canvas.width?!1:e.y<this.canvas.height&&e.active)),this.bullets=this.bullets.filter(e=>{if(!e.isPlayerBullet)return!0;const h=this.aliens.find(s=>e.x<s.x+s.width&&e.x+e.width>s.x&&e.y<s.y+s.height&&e.y+e.height>s.y);return h?(this.createExplosion(h.x+h.width/2,h.y+h.height/2),this.aliens=this.aliens.filter(s=>s!==h),this.score+=100,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("galagaHighScore",this.highScore.toString())),!1):!0})}draw(){if(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawStars(),!this.gameStarted){this.ctx.fillStyle="#fff",this.ctx.font="48px Arial",this.ctx.textAlign="center",this.ctx.fillText("GALAGA",this.canvas.width/2,this.canvas.height/2-50),this.ctx.font="24px Arial",this.ctx.fillText("Press SPACE to start",this.canvas.width/2,this.canvas.height/2+50),this.ctx.fillStyle="#f00",this.ctx.fillText("HIGH SCORE",this.canvas.width/2,30),this.ctx.fillStyle="#fff",this.ctx.fillText(this.highScore.toString(),this.canvas.width/2,60);return}this.ctx.font="24px Arial",this.ctx.fillStyle="#fff",this.ctx.textAlign="left",this.ctx.fillText(`Score: ${this.score}`,10,30),this.ctx.textAlign="center",this.ctx.fillStyle="#f00",this.ctx.fillText("HIGH SCORE",this.canvas.width/2,30),this.ctx.fillStyle="#fff",this.ctx.fillText(this.highScore.toString(),this.canvas.width/2,60),this.ctx.textAlign="right",this.ctx.fillStyle="#fff",this.ctx.fillText(`Level: ${this.level}`,this.canvas.width-10,30),this.explosions.forEach(t=>{const i=this.ctx.createRadialGradient(t.x,t.y,0,t.x,t.y,t.radius);i.addColorStop(0,"rgba(255, 255, 0, 0.8)"),i.addColorStop(.5,"rgba(255, 100, 0, 0.5)"),i.addColorStop(1,"rgba(255, 0, 0, 0)"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,Math.PI*2),this.ctx.fill()}),this.gameOver||(this.ctx.save(),this.ctx.translate(this.player.x+this.player.width/2,this.player.y+this.player.height),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(this.player.width/2,0),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(-this.player.width/4,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(this.player.width/2,0),this.ctx.lineTo(this.player.width/4,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.ellipse(0,-this.player.height/2,this.player.width/6,this.player.height/4,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.moveTo(-this.player.width/2,0),this.ctx.lineTo(-this.player.width/2-10,-this.player.height/3),this.ctx.lineTo(-this.player.width/2,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(this.player.width/2,0),this.ctx.lineTo(this.player.width/2+10,-this.player.height/3),this.ctx.lineTo(this.player.width/2,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.shadowColor="#fff",this.ctx.shadowBlur=10,this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(this.player.width/2,0),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()),this.ctx.fillStyle="#fff",this.bullets.forEach(t=>{this.ctx.fillRect(t.x,t.y,t.width,t.height)}),this.bombs.forEach(t=>{switch(t.alienType){case 1:this.ctx.fillStyle="#ff0";break;case 2:this.ctx.fillStyle="#f00";break;case 3:this.ctx.fillStyle="#0ff";break;default:this.ctx.fillStyle="#f00"}this.ctx.fillRect(t.x,t.y,t.width,t.height)}),this.aliens.forEach(t=>{switch(this.ctx.save(),this.ctx.translate(t.x+t.width/2,t.y+t.height/2),t.type){case 1:this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.ellipse(-t.width/2,-t.height/6,t.width/2.5,t.height/4,Math.PI/4,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.ellipse(t.width/2,-t.height/6,t.width/2.5,t.height/4,-Math.PI/4,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#ff0",this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#000",this.ctx.fillRect(-t.width/3,-t.height/4,t.width/1.5,t.height/8),this.ctx.fillRect(-t.width/3,t.height/8,t.width/1.5,t.height/8),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill();break;case 2:this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.2,-t.height/3,-t.width,-t.height/4,-t.width/2,t.height/2),this.ctx.bezierCurveTo(-t.width/2.5,t.height/3,-t.width/3,-t.height/6,-t.width/2,-t.height/6),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.2,-t.height/3,t.width,-t.height/4,t.width/2,t.height/2),this.ctx.bezierCurveTo(t.width/2.5,t.height/3,t.width/3,-t.height/6,t.width/2,-t.height/6),this.ctx.fill(),this.ctx.strokeStyle="#800",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.5,-t.height/4,-t.width/1.3,-t.height/5,-t.width/2,t.height/4),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.5,-t.height/4,t.width/1.3,-t.height/5,t.width/2,t.height/4),this.ctx.stroke();const i=this.ctx.createLinearGradient(0,-t.height/2,0,t.height/2);i.addColorStop(0,"#fff"),i.addColorStop(1,"#4af"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#000",this.ctx.beginPath(),this.ctx.arc(-t.width/5,-t.height/4,t.width/6,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/5,-t.height/4,t.width/6,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(-t.width/5,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/5,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.arc(0,0,t.width/6,0,Math.PI*2),this.ctx.fill();break;case 3:this.ctx.fillStyle="#808",this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.8,t.height/3,-t.width/2,t.height/2,-t.width/2.5,t.height*.8),this.ctx.bezierCurveTo(-t.width/3,t.height/2,-t.width/2.5,t.height/3,-t.width/2,-t.height/6),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.8,t.height/3,t.width/2,t.height/2,t.width/2.5,t.height*.8),this.ctx.bezierCurveTo(t.width/3,t.height/2,t.width/2.5,t.height/3,t.width/2,-t.height/6),this.ctx.fill(),this.ctx.strokeStyle="#404",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.9,t.height/4,-t.width/2.2,t.height/2,-t.width/2.5,t.height*.8),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.9,t.height/4,t.width/2.2,t.height/2,t.width/2.5,t.height*.8),this.ctx.stroke(),this.ctx.fillStyle="#a0a",this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.shadowColor="#f0f",this.ctx.shadowBlur=10,this.ctx.fillStyle="#f0f",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#f0f",[{x:0,y:0},{x:-t.width/6,y:t.height/4},{x:t.width/6,y:t.height/4}].forEach(h=>{this.ctx.beginPath(),this.ctx.arc(h.x,h.y,t.width/16,0,Math.PI*2),this.ctx.fill()});break}this.ctx.strokeStyle="#000",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(-t.width/8,-t.height/2),this.ctx.lineTo(-t.width/6,-t.height),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/8,-t.height/2),this.ctx.lineTo(t.width/6,-t.height),this.ctx.stroke(),this.ctx.shadowColor=t.type===1?"#ff0":t.type===2?"#fff":"#00f",this.ctx.shadowBlur=10,this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.stroke(),this.ctx.restore()}),this.gameOver&&(this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#fff",this.ctx.font="48px Arial",this.ctx.textAlign="center",this.ctx.fillText("GAME OVER",this.canvas.width/2,this.canvas.height/2),Date.now()-this.gameOverTime>=this.MIN_GAME_OVER_DURATION&&(this.ctx.font="24px Arial",this.ctx.fillText("Press SPACE to restart",this.canvas.width/2,this.canvas.height/2+50))),this.ctx.font="16px Arial",this.ctx.textAlign="left",this.ctx.fillText("Press M to toggle sound",10,this.canvas.height-10)}gameLoop(){this.handleInput(),this.update(),this.draw(),requestAnimationFrame(()=>this.gameLoop())}}new A;
