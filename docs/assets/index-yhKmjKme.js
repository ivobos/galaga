var C=Object.defineProperty;var M=(x,e,i)=>e in x?C(x,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):x[e]=i;var o=(x,e,i)=>M(x,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))t(h);new MutationObserver(h=>{for(const s of h)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function i(h){const s={};return h.integrity&&(s.integrity=h.integrity),h.referrerPolicy&&(s.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?s.credentials="include":h.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(h){if(h.ep)return;h.ep=!0;const s=i(h);fetch(h.href,s)}})();class A{constructor(){o(this,"audioContext");o(this,"enabled");o(this,"gameOver");this.enabled=!0,this.gameOver=!1,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}setGameOver(e){this.gameOver=e}playShoot(){if(!this.enabled||this.gameOver)return;const e=this.audioContext.createOscillator(),i=this.audioContext.createGain();e.type="square",e.frequency.setValueAtTime(880,this.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(110,this.audioContext.currentTime+.1),i.gain.setValueAtTime(.08,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.1),e.connect(i),i.connect(this.audioContext.destination),e.start(),e.stop(this.audioContext.currentTime+.1)}playBombDrop(){if(!this.enabled||this.gameOver)return;const e=this.audioContext.createOscillator(),i=this.audioContext.createGain();e.type="sine",e.frequency.setValueAtTime(440,this.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(220,this.audioContext.currentTime+.3),i.gain.setValueAtTime(.02,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.3),e.connect(i),i.connect(this.audioContext.destination),e.start(),e.stop(this.audioContext.currentTime+.3)}playExplosion(){if(!this.enabled||this.gameOver)return;const e=this.audioContext.createBufferSource(),i=this.audioContext.createBuffer(1,this.audioContext.sampleRate*.3,this.audioContext.sampleRate),t=i.getChannelData(0);for(let a=0;a<i.length;a++)t[a]=Math.random()*2-1;e.buffer=i;const h=this.audioContext.createBiquadFilter();h.type="lowpass",h.frequency.setValueAtTime(1e3,this.audioContext.currentTime),h.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+.3);const s=this.audioContext.createGain();s.gain.setValueAtTime(.1,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.3),e.connect(h),h.connect(s),s.connect(this.audioContext.destination),e.start(),e.stop(this.audioContext.currentTime+.3)}playGameOver(){if(!this.enabled||this.gameOver)return;const e=this.audioContext.createBufferSource(),i=this.audioContext.createBuffer(1,this.audioContext.sampleRate*2,this.audioContext.sampleRate),t=i.getChannelData(0);for(let l=0;l<i.length;l++){const c=1-l/i.length;t[l]=(Math.random()*2-1)*c}e.buffer=i;const h=this.audioContext.createBiquadFilter();h.type="lowpass",h.frequency.setValueAtTime(2e3,this.audioContext.currentTime),h.frequency.exponentialRampToValueAtTime(50,this.audioContext.currentTime+2);const s=this.audioContext.createGain();s.gain.setValueAtTime(.15,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+2);const a=this.audioContext.createOscillator();a.type="sine",a.frequency.setValueAtTime(220,this.audioContext.currentTime),a.frequency.exponentialRampToValueAtTime(110,this.audioContext.currentTime+2);const r=this.audioContext.createGain();r.gain.setValueAtTime(.05,this.audioContext.currentTime),r.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+2),e.connect(h),h.connect(s),s.connect(this.audioContext.destination),a.connect(r),r.connect(this.audioContext.destination),e.start(),a.start(),e.stop(this.audioContext.currentTime+2),a.stop(this.audioContext.currentTime+2)}playAlienTurn(){if(!this.enabled||this.gameOver)return;const e=this.audioContext.createOscillator(),i=this.audioContext.createGain();e.type="sine",e.frequency.setValueAtTime(330,this.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(440,this.audioContext.currentTime+.2),i.gain.setValueAtTime(.03,this.audioContext.currentTime),i.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.2),e.connect(i),i.connect(this.audioContext.destination),e.start(),e.stop(this.audioContext.currentTime+.2)}playAlienHover(e){if(!this.enabled||this.gameOver)return;const i=this.audioContext.createOscillator(),t=this.audioContext.createGain();switch(e){case 1:i.type="sawtooth",i.frequency.setValueAtTime(880,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(1760,this.audioContext.currentTime+.05),t.gain.setValueAtTime(.015,this.audioContext.currentTime);break;case 2:i.type="square",i.frequency.setValueAtTime(660,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(880,this.audioContext.currentTime+.05),t.gain.setValueAtTime(.02,this.audioContext.currentTime);break;case 3:i.type="sawtooth",i.frequency.setValueAtTime(440,this.audioContext.currentTime),i.frequency.exponentialRampToValueAtTime(660,this.audioContext.currentTime+.05),t.gain.setValueAtTime(.018,this.audioContext.currentTime);break}t.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.05),i.connect(t),t.connect(this.audioContext.destination),i.start(),i.stop(this.audioContext.currentTime+.05)}toggle(){this.enabled=!this.enabled}isEnabled(){return this.enabled}}class O{constructor(){o(this,"canvas");o(this,"ctx");o(this,"player");o(this,"bullets");o(this,"aliens");o(this,"bombs");o(this,"explosions");o(this,"stars");o(this,"keys");o(this,"lastBulletTime");o(this,"BULLET_COOLDOWN",100);o(this,"MAX_PLAYER_BULLETS",5);o(this,"gameOver");o(this,"gameStartTime");o(this,"gameOverTime");o(this,"MIN_GAME_OVER_DURATION",3e3);o(this,"soundManager");o(this,"score");o(this,"highScore");o(this,"level");o(this,"levelStartTime");o(this,"LEVEL_START_DELAY",2e3);o(this,"gameStarted");o(this,"starPulseTime");o(this,"scale",1);o(this,"baseHeight",600);this.canvas=document.getElementById("gameCanvas"),this.ctx=this.canvas.getContext("2d"),this.handleResize(),window.addEventListener("resize",()=>this.handleResize()),this.isMobile()&&document.documentElement.requestFullscreen().catch(e=>{console.log("Error attempting to enable fullscreen:",e)}),this.player={x:this.canvas.width/2,y:this.canvas.height-100,width:30*this.scale,height:30*this.scale,speed:5*this.scale},this.bullets=[],this.aliens=[],this.bombs=[],this.explosions=[],this.stars=[],this.keys={},this.lastBulletTime=0,this.gameOver=!1,this.gameStarted=!1,this.gameStartTime=Date.now(),this.gameOverTime=0,this.starPulseTime=0,this.soundManager=new A,this.score=0,this.highScore=parseInt(localStorage.getItem("galagaHighScore")||"0"),this.level=1,this.levelStartTime=Date.now(),this.initStars(),window.addEventListener("keydown",e=>this.keys[e.key]=!0),window.addEventListener("keyup",e=>this.keys[e.key]=!1),window.addEventListener("keydown",e=>{e.key.toLowerCase()==="m"&&this.soundManager.toggle()}),this.canvas.addEventListener("touchstart",e=>{e.preventDefault();const i=e.touches[0],t=this.canvas.getBoundingClientRect(),h=i.clientX-t.left,s=i.clientY-t.top,a=10,r=this.canvas.height-10;if(h>=a&&h<=a+150&&s>=r-20&&s<=r){this.soundManager.toggle();return}this.handleTouch(e)}),this.canvas.addEventListener("touchmove",e=>{e.preventDefault(),this.handleTouch(e)}),this.canvas.addEventListener("touchend",e=>{e.preventDefault(),this.keys[" "]=!1}),this.canvas.addEventListener("click",e=>{const i=this.canvas.getBoundingClientRect(),t=e.clientX-i.left,h=e.clientY-i.top,s=10,a=this.canvas.height-10;if(t>=s&&t<=s+150&&h>=a-20&&h<=a){this.soundManager.toggle();return}this.gameStarted?this.gameOver&&Date.now()-this.gameOverTime>=this.MIN_GAME_OVER_DURATION&&this.reset():(this.gameStarted=!0,this.initAliens())}),this.gameLoop()}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}handleResize(){const e=window.innerWidth,i=window.innerHeight,t=9/16;if(this.isMobile())this.canvas.width=e*.95,this.canvas.height=this.canvas.width/t,this.canvas.height>i*.9&&(this.canvas.height=i*.9,this.canvas.width=this.canvas.height*t);else{const h=e/(this.baseHeight*t),s=i/this.baseHeight;this.scale=Math.min(h,s),this.canvas.width=this.baseHeight*t*this.scale,this.canvas.height=this.baseHeight*this.scale}this.scale=this.canvas.width/(this.baseHeight*t),this.canvas.style.position="absolute",this.canvas.style.left=`${(e-this.canvas.width)/2}px`,this.canvas.style.top=`${(i-this.canvas.height)/2}px`,this.player&&(this.player.width=30*this.scale,this.player.height=30*this.scale,this.player.speed=5*this.scale,this.player.x=Math.min(this.player.x,this.canvas.width-this.player.width),this.player.y=this.canvas.height-100*this.scale),this.ctx.font=`${24*this.scale}px Arial`}handleTouch(e){const i=e.touches[0],t=this.canvas.getBoundingClientRect(),s=(i.clientX-t.left)/this.scale-(this.player.x+this.player.width/2);if(Math.abs(s)>0){this.player.x+=s/Math.abs(s)*this.player.speed;const a=20*this.scale;this.player.x=Math.max(a,Math.min(this.canvas.width-this.player.width-a,this.player.x))}this.keys[" "]=!0}createExplosion(e,i){this.explosions.push({x:e,y:i,radius:0,maxRadius:50,speed:2,active:!0}),this.soundManager.playExplosion()}initAliens(){const t=10+(this.level-1)*5,h=Math.ceil(Math.sqrt(t)),s=Math.ceil(t/h),a=60*this.scale,r=(this.canvas.width-h*a)/2,l=50*this.scale,c=500,n=2*this.scale,d=.2*this.scale,f=n+(this.level-1)*d;let u=0;for(let m=0;m<s&&u<t;m++)for(let w=0;w<h&&u<t;w++){const T=r+w*a,S=l+m*a;let y,p;const P=Math.random();P<.4?(y=-100*this.scale,p=this.canvas.height*.8+Math.random()*50*this.scale):P<.8?(y=this.canvas.width+100*this.scale,p=this.canvas.height*.8+Math.random()*50*this.scale):(y=T+(Math.random()-.5)*100*this.scale,p=-100*this.scale);const b=Math.random();let g;b<.1?g=3:b<.4?g=2:g=1;let v=f;g===2?v=f*1.5:g===3&&(v=f*.7),this.aliens.push({x:y,y:p,width:30*this.scale,height:30*this.scale,speed:v+Math.random(),direction:1,verticalSpeed:0,moveTimer:Date.now(),moveInterval:Math.max(500,1e3-(this.level-1)*50),lastBombTime:0,bombInterval:Math.max(500,1e3-(this.level-1)*50),nextBombDelay:1e3+Math.random()*1500,canDropBombs:!1,targetX:T,targetY:S,state:0,swoopPhase:Math.random()*Math.PI*2,swoopAmplitude:30*this.scale+Math.random()*20*this.scale,swoopSpeed:g===3?.04+Math.random()*.02:.02+Math.random()*.02,attackStartTime:0,originalX:T,originalY:S,entryDelay:u*c,type:g,bombSequence:0,lastBombSequence:0,isLeader:!1,followingLeader:null,attackPath:[],attackPathIndex:0}),u++}}initStars(){for(let e=0;e<100;e++)this.stars.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,size:Math.random()*2+1,speed:Math.random()*1.2+.5,color:this.getRandomDullColor()})}getRandomDullColor(){const e=["#8a8a8a","#8a4a4a","#4a8a4a","#4a4a8a","#8a8a4a","#8a4a8a","#4a8a8a","#6a6a8a","#8a6a4a"];return e[Math.floor(Math.random()*e.length)]}updateStars(){const e=Date.now();this.starPulseTime=(e-this.gameStartTime)/1e3,this.stars.forEach(i=>{if(this.gameStarted)i.y+=i.speed,i.y>this.canvas.height&&(i.y=0,i.x=Math.random()*this.canvas.width);else{const t=Math.sin(this.starPulseTime*2+i.x*.01)*.5+.5;i.size=(Math.random()*2+1)*(.5+t*.5)}})}drawStars(){this.stars.forEach(e=>{this.ctx.fillStyle=e.color,this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,Math.PI*2),this.ctx.fill()})}handleInput(){if(!this.gameStarted){(this.keys[" "]||this.keys.touch)&&(this.gameStarted=!0,this.initAliens());return}if(this.gameOver){const e=Date.now()-this.gameOverTime;(this.keys[" "]||this.keys.touch)&&e>=this.MIN_GAME_OVER_DURATION&&this.reset();return}if(this.keys.ArrowLeft){const e=20*this.scale;this.player.x=Math.max(e,this.player.x-this.player.speed)}if(this.keys.ArrowRight){const e=20*this.scale;this.player.x=Math.min(this.canvas.width-this.player.width-e,this.player.x+this.player.speed)}this.keys[" "]&&Date.now()-this.lastBulletTime>this.BULLET_COOLDOWN&&this.bullets.filter(i=>i.isPlayerBullet).length<this.MAX_PLAYER_BULLETS&&(this.bullets.push({x:this.player.x+this.player.width/2-2,y:this.player.y,width:4,height:10,speed:7,isPlayerBullet:!0}),this.lastBulletTime=Date.now(),this.soundManager.playShoot())}reset(){this.player.x=this.canvas.width/2,this.player.y=this.canvas.height-100,this.bullets=[],this.bombs=[],this.explosions=[],this.aliens=[],this.stars=[],this.gameOver=!1,this.gameStarted=!1,this.gameOverTime=0,this.lastBulletTime=0,this.gameStartTime=Date.now(),this.score=0,this.level=1,this.levelStartTime=Date.now(),this.initStars(),this.soundManager.setGameOver(!1)}handlePlayerDeath(){this.createExplosion(this.player.x+this.player.width/2,this.player.y+this.player.height/2),this.gameOver=!0,this.gameOverTime=Date.now(),this.soundManager.setGameOver(!0),this.soundManager.playGameOver()}startNextLevel(){this.score+=1e3,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("galagaHighScore",this.highScore.toString())),this.level++,this.levelStartTime=Date.now(),this.initAliens()}update(){const e=Date.now(),i=e-this.gameStartTime;this.updateStars(),this.aliens.length===0&&e-this.levelStartTime>this.LEVEL_START_DELAY&&this.startNextLevel(),this.explosions=this.explosions.filter(t=>(t.radius+=t.speed,t.radius<t.maxRadius)),this.bullets=this.bullets.filter(t=>(t.isPlayerBullet?t.y-=t.speed:t.y+=t.speed,!this.gameOver&&!t.isPlayerBullet&&t.x<this.player.x+this.player.width&&t.x+t.width>this.player.x&&t.y<this.player.y+this.player.height&&t.y+t.height>this.player.y?(this.handlePlayerDeath(),!1):t.y>0&&t.y<this.canvas.height)),this.aliens.forEach(t=>{if(t.state===0&&i>=t.entryDelay&&(t.state=1),t.state!==0){if(!this.gameOver&&t.x<this.player.x+this.player.width&&t.x+t.width>this.player.x&&t.y<this.player.y+this.player.height&&t.y+t.height>this.player.y){this.handlePlayerDeath();return}switch(t.state){case 1:const h=t.targetX-t.x,s=t.targetY-t.y,a=Math.sqrt(h*h+s*s);a<5?(t.x=t.targetX,t.y=t.targetY,t.state=t.type===4?3:2,t.speed=2,t.originalX=t.x,t.originalY=t.y,t.moveTimer=e):(t.x+=h/a*t.speed,t.y+=s/a*t.speed);break;case 2:if(e-t.moveTimer>t.moveInterval&&this.aliens.forEach(r=>{r.state===2&&(r.direction*=-1,r.moveTimer=e,this.soundManager.playAlienHover(r.type))}),t.x+=t.speed*t.direction,t.x<0?(t.x=0,t.direction*=-1,this.soundManager.playAlienHover(t.type)):t.x+t.width>this.canvas.width&&(t.x=this.canvas.width-t.width,t.direction*=-1,this.soundManager.playAlienHover(t.type)),t.originalX=t.x,Math.random()<.001){t.state=3,t.attackStartTime=e,t.swoopPhase=0,t.isLeader=!0,t.attackPath=[],t.attackPathIndex=0;const r=this.aliens.filter(c=>c!==t&&c.state===2&&Math.abs(c.x-t.x)<100&&Math.abs(c.y-t.y)<100),l=Math.min(2,r.length);for(let c=0;c<l;c++){const n=r[c];n.state=3,n.attackStartTime=e+500,n.isLeader=!1,n.followingLeader=t,n.attackPath=[],n.attackPathIndex=0}}t.canDropBombs||e-t.entryDelay>t.nextBombDelay&&(t.canDropBombs=!0,t.lastBombTime=e);break;case 3:if(t.type===4){const r=e*.001,l=t.originalX+Math.sin(r*t.swoopSpeed)*t.swoopAmplitude,c=t.originalY+Math.sin(r*t.swoopSpeed*2)*(t.swoopAmplitude*.7),n=l-t.x,d=c-t.y;t.x+=n*.4,t.y+=d*.4,Math.random()<.04&&this.soundManager.playAlienHover(4),t.x<0&&(t.x=0),t.x+t.width>this.canvas.width&&(t.x=this.canvas.width-t.width),t.y<0&&(t.y=0),t.y+t.height>this.canvas.height&&(t.y=this.canvas.height-t.height)}else{const l=(e-t.attackStartTime)/3e3;if(l>=1)t.state=2,t.x=t.originalX,t.y=t.originalY,t.isLeader=!1,t.followingLeader=null,t.attackPath=[],t.attackPathIndex=0,this.soundManager.playAlienHover(t.type);else if(t.isLeader){const c=t.originalX+Math.sin(l*Math.PI*2)*100,n=t.originalY+Math.sin(l*Math.PI)*300;t.attackPath.push({x:c,y:n});const d=c-t.x,f=n-t.y;t.x+=d*.1,t.y+=f*.1}else if(t.followingLeader&&t.followingLeader.attackPath.length>0&&(t.attackPath.length===0&&(t.attackPath=[...t.followingLeader.attackPath]),t.attackPathIndex<t.attackPath.length)){const c=t.attackPath[t.attackPathIndex];if(c){const n=c.x-t.x,d=c.y-t.y;Math.sqrt(n*n+d*d)<5?t.attackPathIndex++:(t.x+=n*.1,t.y+=d*.1)}}}break}t.canDropBombs&&e-t.lastBombTime>(t.state===3?t.bombInterval*.3:t.bombInterval)&&t.y>0&&t.y<this.canvas.height&&(t.type===3?(t.bombSequence===0&&(t.bombSequence=1,t.lastBombSequence=e),t.bombSequence<=8&&e-t.lastBombSequence<2e3?(this.bombs.push({x:t.x+t.width/2-2,y:t.y+t.height,width:4,height:10,speed:3,horizontalSpeed:-1,active:!0,alienType:t.type}),this.bombs.push({x:t.x+t.width/2-2,y:t.y+t.height,width:4,height:10,speed:3,horizontalSpeed:1,active:!0,alienType:t.type}),t.bombSequence++,t.lastBombTime=e+50,this.soundManager.playBombDrop()):(t.bombSequence=0,t.lastBombTime=e+500+Math.random()*1e3)):(this.bombs.push({x:t.x+t.width/2-2,y:t.y+t.height,width:4,height:10,speed:3,horizontalSpeed:t.direction*.5,active:!0,alienType:t.type}),t.lastBombTime=e+200+Math.random()*800,this.soundManager.playBombDrop()))}}),this.bombs=this.bombs.filter(t=>(t.y+=t.speed,t.x+=t.horizontalSpeed,!this.gameOver&&t.active&&t.x<this.player.x+this.player.width&&t.x+t.width>this.player.x&&t.y<this.player.y+this.player.height&&t.y+t.height>this.player.y?(this.handlePlayerDeath(),!1):t.x<-t.width||t.x>this.canvas.width?!1:t.y<this.canvas.height&&t.active)),this.bullets=this.bullets.filter(t=>{if(!t.isPlayerBullet)return!0;const h=this.aliens.find(s=>t.x<s.x+s.width&&t.x+t.width>s.x&&t.y<s.y+s.height&&t.y+t.height>s.y);return h?(this.createExplosion(h.x+h.width/2,h.y+h.height/2),this.aliens=this.aliens.filter(s=>s!==h),this.score+=100,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("galagaHighScore",this.highScore.toString())),!1):!0})}draw(){if(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawStars(),!this.gameStarted){this.ctx.fillStyle="#fff",this.ctx.font=`${36*this.scale}px Arial`,this.ctx.textAlign="center",this.ctx.fillText("GALAGA",this.canvas.width/2,this.canvas.height/2-50*this.scale),this.ctx.font=`${18*this.scale}px Arial`,this.ctx.fillText("100% vibe coded",this.canvas.width/2,this.canvas.height/2-10*this.scale),this.ctx.fillText("Press SPACE or touch screen to start",this.canvas.width/2,this.canvas.height/2+50*this.scale),this.ctx.fillStyle="#f00",this.ctx.font=`${16*this.scale}px Arial`,this.ctx.fillText("HIGH SCORE",this.canvas.width/2,30*this.scale),this.ctx.fillStyle="#fff",this.ctx.fillText(this.highScore.toString(),this.canvas.width/2,50*this.scale);return}if(this.ctx.font=`${20*this.scale}px Arial`,this.ctx.fillStyle="#fff",this.ctx.textAlign="left",this.ctx.fillText("SCORE",10*this.scale,30*this.scale),this.ctx.fillText(this.score.toString(),10*this.scale,55*this.scale),this.ctx.textAlign="center",this.ctx.fillStyle="#f00",this.ctx.font=`${16*this.scale}px Arial`,this.ctx.fillText("HIGH SCORE",this.canvas.width/2,30*this.scale),this.ctx.fillStyle="#fff",this.ctx.fillText(this.highScore.toString(),this.canvas.width/2,55*this.scale),this.ctx.textAlign="right",this.ctx.fillStyle="#fff",this.ctx.fillText("LEVEL",this.canvas.width-10*this.scale,30*this.scale),this.ctx.fillText(this.level.toString(),this.canvas.width-10*this.scale,55*this.scale),this.explosions.forEach(t=>{const h=this.ctx.createRadialGradient(t.x,t.y,0,t.x,t.y,t.radius);h.addColorStop(0,"rgba(255, 255, 0, 0.8)"),h.addColorStop(.5,"rgba(255, 100, 0, 0.5)"),h.addColorStop(1,"rgba(255, 0, 0, 0)"),this.ctx.fillStyle=h,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,Math.PI*2),this.ctx.fill()}),!this.gameOver){this.ctx.save(),this.ctx.translate(this.player.x+this.player.width/2,this.player.y+this.player.height),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(this.player.width/2,0),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(-this.player.width/4,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(this.player.width/2,0),this.ctx.lineTo(this.player.width/4,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.ellipse(0,-this.player.height/2,this.player.width/6,this.player.height/4,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.moveTo(-this.player.width/2,0),this.ctx.lineTo(-this.player.width/2-10,-this.player.height/3),this.ctx.lineTo(-this.player.width/2,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(this.player.width/2,0),this.ctx.lineTo(this.player.width/2+10,-this.player.height/3),this.ctx.lineTo(this.player.width/2,-this.player.height/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.rect(-this.player.width/2-2,-this.player.height/3,4,8),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.rect(-this.player.width/2-2,-this.player.height/2,4,8),this.ctx.fill(),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.rect(this.player.width/2-2,-this.player.height/3,4,8),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.rect(this.player.width/2-2,-this.player.height/2,4,8),this.ctx.fill();const t=Date.now()*.005,h=10+Math.sin(t*2)*5,s=this.ctx.createLinearGradient(0,0,0,h);s.addColorStop(0,"#ff0"),s.addColorStop(.5,"#f80"),s.addColorStop(1,"#f00"),this.ctx.shadowColor="#f00",this.ctx.shadowBlur=15,this.ctx.shadowOffsetY=2,this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.moveTo(-this.player.width/4,0),this.ctx.lineTo(-this.player.width/6,h),this.ctx.lineTo(-this.player.width/8,0),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.moveTo(this.player.width/4,0),this.ctx.lineTo(this.player.width/6,h),this.ctx.lineTo(this.player.width/8,0),this.ctx.closePath(),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.shadowOffsetY=0,this.ctx.shadowColor="#fff",this.ctx.shadowBlur=10,this.ctx.beginPath(),this.ctx.moveTo(0,-this.player.height),this.ctx.lineTo(-this.player.width/2,0),this.ctx.lineTo(this.player.width/2,0),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()}this.ctx.fillStyle="#fff",this.bullets.forEach(t=>{this.ctx.fillRect(t.x,t.y,t.width,t.height)}),this.bombs.forEach(t=>{switch(t.alienType){case 1:this.ctx.fillStyle="#ff0";break;case 2:this.ctx.fillStyle="#f00";break;case 3:this.ctx.fillStyle="#0ff";break;default:this.ctx.fillStyle="#f00"}this.ctx.fillRect(t.x,t.y,t.width,t.height)}),this.aliens.forEach(t=>{switch(this.ctx.save(),this.ctx.translate(t.x+t.width/2,t.y+t.height/2),t.type){case 1:this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.ellipse(-t.width/2,-t.height/6,t.width/2.5,t.height/4,Math.PI/4,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.ellipse(t.width/2,-t.height/6,t.width/2.5,t.height/4,-Math.PI/4,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#ff0",this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#000",this.ctx.fillRect(-t.width/3,-t.height/4,t.width/1.5,t.height/8),this.ctx.fillRect(-t.width/3,t.height/8,t.width/1.5,t.height/8),this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill();break;case 2:this.ctx.fillStyle="#f00",this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.2,-t.height/3,-t.width,-t.height/4,-t.width/2,t.height/2),this.ctx.bezierCurveTo(-t.width/2.5,t.height/3,-t.width/3,-t.height/6,-t.width/2,-t.height/6),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.2,-t.height/3,t.width,-t.height/4,t.width/2,t.height/2),this.ctx.bezierCurveTo(t.width/2.5,t.height/3,t.width/3,-t.height/6,t.width/2,-t.height/6),this.ctx.fill(),this.ctx.strokeStyle="#800",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.5,-t.height/4,-t.width/1.3,-t.height/5,-t.width/2,t.height/4),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.5,-t.height/4,t.width/1.3,-t.height/5,t.width/2,t.height/4),this.ctx.stroke();const h=this.ctx.createLinearGradient(0,-t.height/2,0,t.height/2);h.addColorStop(0,"#fff"),h.addColorStop(1,"#4af"),this.ctx.fillStyle=h,this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#000",this.ctx.beginPath(),this.ctx.arc(-t.width/5,-t.height/4,t.width/6,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/5,-t.height/4,t.width/6,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(-t.width/5,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/5,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#00f",this.ctx.beginPath(),this.ctx.arc(0,0,t.width/6,0,Math.PI*2),this.ctx.fill();break;case 3:this.ctx.fillStyle="#808",this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.8,t.height/3,-t.width/2,t.height/2,-t.width/2.5,t.height*.8),this.ctx.bezierCurveTo(-t.width/3,t.height/2,-t.width/2.5,t.height/3,-t.width/2,-t.height/6),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.8,t.height/3,t.width/2,t.height/2,t.width/2.5,t.height*.8),this.ctx.bezierCurveTo(t.width/3,t.height/2,t.width/2.5,t.height/3,t.width/2,-t.height/6),this.ctx.fill(),this.ctx.strokeStyle="#404",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(-t.width/2,-t.height/6),this.ctx.bezierCurveTo(-t.width/1.9,t.height/4,-t.width/2.2,t.height/2,-t.width/2.5,t.height*.8),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/2,-t.height/6),this.ctx.bezierCurveTo(t.width/1.9,t.height/4,t.width/2.2,t.height/2,t.width/2.5,t.height*.8),this.ctx.stroke(),this.ctx.fillStyle="#a0a",this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.fill(),this.ctx.shadowColor="#f0f",this.ctx.shadowBlur=10,this.ctx.fillStyle="#f0f",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/8,0,Math.PI*2),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(-t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t.width/6,-t.height/4,t.width/12,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#f0f",[{x:0,y:0},{x:-t.width/6,y:t.height/4},{x:t.width/6,y:t.height/4}].forEach(a=>{this.ctx.beginPath(),this.ctx.arc(a.x,a.y,t.width/16,0,Math.PI*2),this.ctx.fill()});break}this.ctx.strokeStyle="#000",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(-t.width/8,-t.height/2),this.ctx.lineTo(-t.width/6,-t.height),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.width/8,-t.height/2),this.ctx.lineTo(t.width/6,-t.height),this.ctx.stroke(),this.ctx.shadowColor=t.type===1?"#ff0":t.type===2?"#fff":"#00f",this.ctx.shadowBlur=10,this.ctx.beginPath(),this.ctx.ellipse(0,0,t.width/3,t.height/2,0,0,Math.PI*2),this.ctx.stroke(),this.ctx.restore()}),this.gameOver&&(this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#fff",this.ctx.font=`${36*this.scale}px Arial`,this.ctx.textAlign="center",this.ctx.fillText("GAME OVER",this.canvas.width/2,this.canvas.height/2),Date.now()-this.gameOverTime>=this.MIN_GAME_OVER_DURATION&&(this.ctx.font=`${18*this.scale}px Arial`,this.ctx.fillText("Press SPACE or touch screen to restart",this.canvas.width/2,this.canvas.height/2+50*this.scale))),this.ctx.font=`${14*this.scale}px Arial`,this.ctx.textAlign="left",this.ctx.fillStyle="#0f0";const e=this.soundManager.isEnabled()?"🔊":"🔇",i=this.isMobile()?"":" (M to toggle)";this.ctx.fillText(`Sound ${e}${i}`,10*this.scale,this.canvas.height-10*this.scale)}gameLoop(){this.handleInput(),this.update(),this.draw(),requestAnimationFrame(()=>this.gameLoop())}}new O;
